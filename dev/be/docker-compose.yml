services:
    # BE 개발 컨테이너 (로컬 소스 바인딩)
    be-server:
        image: golang:1.21-alpine
        working_dir: /app
        volumes:
            # 상위 디렉토리의 BE 레포지토리를 마운트한다고 가정
            - ../../../BE:/app
        ports:
            - "8080:8080"
        command: go run main.go
        depends_on:
            - postgres
            - redis
            - livekit

    # Livekit 서버
    livekit:
        image: livekit/livekit-server:latest
        command: --dev
        ports:
            - "7880:7880"
            - "7881:7881"
            - "7882:7882/udp"

    # 로컬 DB 컨테이너
    postgres:
        image: postgres:15-alpine
        environment:
            POSTGRES_USER: user
            POSTGRES_PASSWORD: password
            POSTGRES_DB: mydb
        ports:
            - "5432:5432"

    redis:
        image: redis:alpine
        ports:
            - "6379:6379"
